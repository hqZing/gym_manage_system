# 接口文档

## /api/register

**接口作用**

进行用户注册

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| u_name| 需要注册的用户名 |
| u_password | 需要设置的密码 |

**访问样例**

```js
/api/register?u_name=tony&u_password=111
```

**成功样例**

```json
{
  "status": 1
}
```

**失败样例**

```json
{
  "info": "存在同名用户，注册失败",
  "status": 0
}

```

```json
{
  "info": "用户名和密码都不能为空",
  "status": 0
}

```

## /api/login_validation

**接口作用**

进行用户登录

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| u_name| 需要登陆的用户名 |
| u_password | 登陆密码 |

**访问样例**

```js
/api/login_validation?u_name=tony&u_password=666
```

**成功样例**

```json
{
  "status": 1
}
```

**失败样例**

```json
{
  "info": "密码不正确",
  "status": 0
}
```

```json
{
  "info": "用户不存在",
  "status": 0
}
```

```json
{
  "info": "用户名和密码都不能留空",
  "status": 0
}
```



## /api/logout

**接口作用**

退出登陆。该接口不需要传参，无论访问失败还是成功，都会得到一个302重定向。

**访问样例**

```js
/api/logout
```

## /api/summary

**接口作用**

获取某一时刻的场地使用状况总览， 可以得出特定时刻各个类型球场的占用状况。参数留空则默认查询当前时刻。

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| time | 需要查询的时刻 |

**访问样例**

```js
/api/summary?time=2019-05-06%2013:00:00
```

**成功样例**

```json
{
  "info_dict": {
    "乒乓球场": "2/3",
    "排球场": "1/3",
    "篮球场": "2/3",
    "羽毛球场": "1/2"
  },
  "status": 1
}
```

```json
{
  "info_dict": {
    "乒乓球场": "0/3",
    "排球场": "0/3",
    "篮球场": "0/3",
    "羽毛球场": "0/2"
  },
  "status": 1
}
```

**失败样例**

不存在失败的情况，若查不到数据则分子为0，也是属于成功状态


## /api/latest

**接口作用**

查询最新的三条预定信息。不需要传参

**访问样例**

```js
/api/latest
```

**成功样例**

```json
{
  "info_list": [
    {
      "cmtime": "2019-05-07 11:04:01",
      "edtime": "2019-05-08 21:00:00",
      "fieldname": "乒乓球1号场",
      "sttime": "2019-05-08 00:00:00",
      "username": "张三"
    },
    {
      "cmtime": "2019-05-06 09:00:00",
      "edtime": "2019-05-06 15:00:00",
      "fieldname": "乒乓球2号场",
      "sttime": "2019-05-06 12:00:00",
      "username": "张三"
    },
    {
      "cmtime": "2019-05-06 08:00:00",
      "edtime": "2019-05-06 15:00:00",
      "fieldname": "乒乓球1号场",
      "sttime": "2019-05-06 12:00:00",
      "username": "张三"
    }
  ],
  "status": 1
}
```

```json
{
  "info_list": [],
  "status": 1
}
```


**失败样例**

没有失败样例，查不到数据只会导致info_list为空。同样是成功状态。

## /api/field_info

**接口作用**

查询所有场地的信息，不需要加参数

**访问样例**

```js
/api/field_info
```

**成功样例**

```json
{
  "info_dict": {
    "乒乓球场": [
      [
        9,
        "乒乓球场",
        "乒乓球1号场",
        10,
        "位于门口"
      ],
      [
        10,
        "乒乓球场",
        "乒乓球2号场",
        10,
        "位于厕所旁边"
      ],
      [
        11,
        "乒乓球场",
        "乒乓球3号场",
        20,
        "今天新建了个场地"
      ]
    ],
    "排球场": [
      [
        6,
        "排球场",
        "排球1号场",
        10,
        "位于球场东北角"
      ],
      [
        7,
        "排球场",
        "排球2号场",
        10,
        "位于过道旁边"
      ],
      [
        8,
        "排球场",
        "排球3号场",
        10,
        "位于后门旁边"
      ]
    ],
    "篮球场": [
      [
        1,
        "篮球场",
        "篮球1号场",
        10,
        "位于2号场旁边"
      ],
      [
        2,
        "篮球场",
        "篮球3号场",
        10,
        "位于1号场旁边"
      ],
      [
        3,
        "篮球场",
        "篮球2号场",
        10,
        "位于角落"
      ]
    ],
    "羽毛球场": [
      [
        4,
        "羽毛球场",
        "羽毛球2号场",
        10,
        "位于门口"
      ],
      [
        5,
        "羽毛球场",
        "羽毛球1号场",
        10,
        "位于角落"
      ]
    ]
  },
  "status": 1
}
```

**失败样例**

无。查不到数据只会返回空的info_list

## /api/field_use

**接口作用**

查询某个场地的预定情况，所有对该场地预定的订单都会显示在上面。当然只显示从现在往后的，已经结束的订单不会再显示。

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| idid | 场地的id |

**访问样例**
```js
/api/field_use?idid=9
```

**成功样例**

```json
{
  "info_list": [
    [
      "张三",
      "乒乓球1号场",
      "2019-05-08 00:00:00",
      "2019-05-08 21:00:00",
      "2019-05-07 11:04:01"
    ]
  ],
  "status": 1
}
```

第0项：预定该场地的用户，的名字
第1项：该场地的名字
第2项：开始使用该场地的时间
第3项：结束使用该场地的时间
第4项：下单时间


**失败样例**

无。查不到数据只会得到空的info_list


## /api/get_field_name

**接口作用**

获取一个场地的名字

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| idid | 场地的id |

**访问样例**

```js
/api/get_field_name?idid=9
```

**成功样例**

```json
{
  "name": "乒乓球1号场",
  "status": 1
}
```

**失败样例**

```json
{
  "info": "获取失败，场地id不存在",
  "status": 0
}
```

## /api/bookit

**接口作用**

预定一个场地

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| idid | 场地的id |
| st | 开始使用的时间 |
| ed | 结束使用的时间 |

**访问样例**

```js
/api/bookit?idid=9&st=2019-05-16%2000:00:00&ed=2019-05-17%2000:00:00
```

**成功样例**

```json
{
  "bookid": 17, 
  "hours": 0, 
  "status": 1, 
  "totalprice": 0.0
}
```

bookid：订单id
hours：使用的时长有多少小时
totalprice: 需要支付的总价

**失败样例**

```json
{
  "info": "起始时间不能为空",
  "status": 0
}
```

```json
{
  "info": "结束时间不能为空",
  "status": 0
}
```

```json
{
  "info": "起始时间不能小于现在",
  "status": 0
}
```

```json
{
  "info": "结束时间不能小于现在",
  "status": 0
}
```

```json
{
  "info": "与别人的预定有时间冲突，请另外选择时间段",
  "status": 0
}
```

## /api/pay

**接口作用**

支付一笔订单

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| idid | 订单的id |

**访问样例**

```js
/api/pay?idid=18
```

**成功样例**

```json
{
  "status": 1
}
```

**失败样例**

无（在目前的设定中没有编写失败的逻辑。默认所有的操作都不会失败）



## /api/news_list

**接口作用**

获取新闻列表。不需要传递参数

**访问样例**

```js
/api/news_list
```

**成功样例**

```json
{
  "info_list": [
    [
      3,
      "大新闻",
      "　原标题：甲骨文创始人曾扬言遏制中国：培养这么多工程师还得了\r\n\r\n　　[观察者网讯]\r\n\r\n　　“如果就这么让中国经济超越我们，让中国培养出比我们更多的工程师，让中国科技公司击败我们的科技公司，那我......"
    ],
    [
      2,
      "标题标题标题",
      "内容内荣内容"
    ],
    [
      1,
      "第三届吹牛逼大赛将于本周五晚在我馆举行",
      "内容内容内容"
    ]
  ],
  "status": 0
}
```

**失败样例**

无。查不到数据只会返回空的info_list


## /api/news_detail

**接口作用**

获取特定某个新闻的新闻详情。

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| idid | 新闻的id |

**访问样例**

```js
/api/news_detail?idid=3
```

**成功样例**

```json
{
  "content": "　原标题：甲骨文创始人曾扬言遏制中国：培养这么多工程师还得了\r\n\r\n　　[观察者网讯]\r\n\r\n　　“如果就这么让中国经济超越我们，让中国培养出比我们更多的工程师，让中国科技公司击败我们的科技公司，那我们就离军事科技也落后的那天不远了。美国与中国的激烈竞争中，我站美国队。”\r\n\r\n　　就在国内媒体日前曝出，美国软件甲骨文（Oracle）确认中国区研发中心（CDC）首批裁员900余人，人数达全员近六成，甚至整个CDC将被关闭都成为内部共识时，甲骨文创始人拉里·埃里森（Larry Ellison）去年受访时的言论，也再次引发讨论。\r\n\r\n　　中国区一下裁员六成，或与创始人有关\r\n\r\n　　据21世纪经济报道5月7日报道，此次裁员后，中国区研发中心的部分业务会被流转到其他地区，而CDC早在2018年底，就关闭了校园和社会两条招聘通道。\r\n\r\n　　另据澎湃新闻报道，一位被裁员工透露，“5月22号之前签解约合同，是N（工作年限）+6（个月薪酬）的赔偿，一个月后，即6月7号签是N+1，再往后就只有N了。”\r\n\r\n　　值得注意的是，甲骨文在中国仍在盈利，有员工无法理解公司为何突然裁员。\r\n\r\n　　不过，此次裁员并非仅在中国实施。一位甲骨文北京办公室被裁员工称，自己不属于中国研发中心，而是属于运维部门，归属印度团队。他也收到了裁员通知，自己的印度老板对此并不知情。\r\n\r\n　　当越来越多细节被曝光后，有中国网友注意到了甲骨文创始人去年10月接受保守派媒体福克斯新闻时的言论，并质疑其多次渲染中国威胁论，并由此猜测此次裁员背后或有政治动机。\r\n社交媒体截图社交媒体截图\r\n\r\n　　“这次甲骨文中国区裁员不单纯是业务因素，可能与其创始人埃里森有关，他之前在美国发表过对中美竞争的看法。”亿欧智库研究员院长由天宇也对《华夏时报》表示。\r\n\r\n　　“如果就这么让中国培养出比美国更多的工程师……”\r\n\r\n　　在福克斯新闻放出的两段受访视频中，著名财经主播玛丽亚·巴蒂罗姆（Maria Bartiromo）向埃里森问道：“你是2016年选举的大金主，你支持的是马尔科·卢比奥（Marco Rubio）。你觉得特朗普做得怎么样？”\r\n\r\n　　而卢比奥被称为共和党派系右派民粹主义运动“茶党运动”的政治新星，曾与台湾地区领导人蔡英文会过面，还有个“反华急先锋”的绰号。\r\n\r\n　　埃里森则称：“我还曾是比尔·克林顿竞选时的第二大捐助者，所以我不是民主党人，也不是共和党人，我倾向于中间派，这意味着会非常孤独，因为这个国家现在非常两极化。”\r\n\r\n　　在随后的采访中，埃里森频频就中美竞争发言称，中国是美国“自上世纪30年代以来的首个严峻对手”，他还暗示不能就这么让中国培养出比美国更多的工程师，而他“站美国队”：\r\n\r\n　　“我认为我们的一大竞争对手就是中国。如果就这么让中国的经济超越我们，让中国培养出比我们更多的工程师，让中国科技公司击败我们的科技公司，那就离我们军事科技也落后的那天不远了，我们科技方面的经济也会落后。”",
  "idid": 3,
  "status": 0,
  "title": "大新闻"
}
```

**失败样例**

```json
{
  "info": "获取失败，新闻id不能为空",
  "status": 0
}
```


## /api/user_book_list

**接口作用**

返回当前用户的有效订单列表（未取消、未过期、已付款这三个条件都同时成立的订单为有效订单）。该接口不需要传参，后端会自动判断当前用户。

**访问样例**

```js
/api/user_book_list
```

**成功样例**

```json
{
  "info_list": [
    [
      18,
      "乒乓球1号场",
      "2019-05-15 00:00:00",
      "2019-05-16 00:00:00",
      "2019-05-07 15:49:55"
    ],
    [
      14,
      "乒乓球1号场",
      "2019-05-08 00:00:00",
      "2019-05-08 21:00:00",
      "2019-05-07 11:04:01"
    ]
  ],
  "status": 1
}
```

第0项：订单id
第1项：场地名字
第2项：开始使用时间
第3项：结束使用时间
第4项：下单时间

**失败样例**

无。查不到数据只会返回空的info_list




## /api/cancel

**接口作用**

取消一笔订单

**参数含义**

| 参数 | 含义 |
| ---- | ---- |
| idid | 订单id |

**访问样例**

```js
/api/cancel?idid=1
```

**成功样例**

```json
{
  "status": 1
}
```

**失败样例**

无。无论如何都会返回成功，查不到订单照样返回成功。

## /api/user_get_profile

**接口作用**

获取当前用户的个人信息。目前只包含了用户名这一项。该接口不需要传参。

**访问样例**

```js
/api/user_get_profile
```

**成功样例**

```json
{
  "status": 1,
  "name": "张三"
}
```

**失败样例**

无。未登录的情况下必定无法访问这个接口，能正常登陆的用户都具有用户名，这个操作不会失败。

## /api/user_change_profile

**接口作用**

修改当前登陆的用户的个人信息。不需要传参，后端会自动判断用户。

**访问样例**

```js
/api/user_change_profile

```

**成功样例**

```json
{
  "status": 1,
  "name": "张三"
}
```

**失败样例**

```json
{
  "status": 0,
  "info": "存在空参数"
}
```

```json
{
  "status": 0,
  "info": "你想要的新用户名已经被其他用户占用"
}
```


## /api/last_operation

**接口作用**

获取当前用户最近的20次操作，包含预定、退订、支付这三个动作。不需要传参，后端会自动判断当前用户

**访问样例**

```js
/api/last_operation
```

**成功样例**

```json
{
  "info_list": [
    {
      "cmtime": "2019-05-08 00:44:27",
      "edtime": "2019-05-08 23:00:00",
      "idid": 13,
      "name": "乒乓球1号场",
      "sttime": "2019-05-08 04:00:00",
      "type": 0
    },
    {
      "cmtime": "2019-05-08 00:44:13",
      "edtime": "2019-05-08 23:00:00",
      "idid": 13,
      "name": "乒乓球1号场",
      "sttime": "2019-05-08 04:00:00",
      "type": 1
    },
    {
      "cmtime": "2019-05-08 00:43:08",
      "edtime": "2019-05-08 12:00:00",
      "idid": 12,
      "name": "乒乓球2号场",
      "sttime": "2019-05-08 04:00:00",
      "type": 0
    },
    {
      "cmtime": "2019-05-08 00:42:13",
      "edtime": "2019-05-07 24:00:00",
      "idid": 1,
      "name": "篮球1号场",
      "sttime": "2019-05-07 12:00:00",
      "type": 0
    }
  ],
  "status": 1
}
```

cmtime: 该动作的执行时间
sttime：开始使用时间
edtime：结束使用时间
idid：订单id
name：球场位置
type：操作类型，1预定，0退订，2支付

**失败样例**

无。查不到数据只会返回空的info_list